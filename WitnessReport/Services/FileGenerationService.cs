using IronPdf;
using System.Linq;
using WitnessReport.Models;
using WitnessReport.Services.Interfaces;

namespace WitnessReport.Services
{
    public class FileGenerationService : IFileGenerationService
    {
        public void GenerateFile(Fugitive fugitive)
        {
            var renderer = new ChromePdfRenderer();

            var pdf = renderer.RenderHtmlAsPdf(GenerateHtml(fugitive));

            var fileName = $"C:\\{fugitive.Title}.pdf";

            pdf.SaveAs(fileName);
        }

        private string GenerateHtml(Fugitive fugitive)
        {
            return "<html><head></head><body>" +
                   $"<h1 style=\"padding-top:3pt;padding-left:119pt;text-indent:0;text-align:center\"><a name=\"bookmark0\">{fugitive.Title}</a></h1><p style=\"padding-top:8pt;padding-left:119pt;text-indent:0;text-align:center\"><a name=\"bookmark1\">{fugitive.Description}</a></p><p style=\"text-indent:0;text-align:left\"><br></p><p style=\"padding-left:219pt;text-indent:0;text-align:left\"><span><table border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><tr><td><img width=\"228\" height=\"242\" src=\"{fugitive.Images.FirstOrDefault()?.Original}\"></td></tr></table></span></p><p class=\"s1\" style=\"padding-top:2pt;padding-left:119pt;text-indent:0;text-align:center\">{fugitive.Images.FirstOrDefault()?.Caption}</p><p style=\"padding-top:3pt;padding-bottom:2pt;padding-left:119pt;text-indent:0;text-align:center\"><a name=\"bookmark2\">DESCRIPTION</a></p><table style=\"border-collapse:collapse;margin-left:1.5pt\" cellspacing=\"0\"><tr style=\"height:15pt\"><td style=\"width:609pt;border-top-style:solid;border-top-width:1pt;border-top-color:#ddd;border-left-style:solid;border-left-width:1pt;border-left-color:#ddd;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#ddd;border-right-style:solid;border-right-width:1pt;border-right-color:#ddd\" colspan=\"2\" bgcolor=\"#EDEDED\"><p class=\"s2\" style=\"padding-top:2pt;padding-left:7pt;text-indent:0;text-align:left\">Aliases:<span class=\"s3\">{string.Join(", ", fugitive.Aliases.ToArray())}</span></p></td></tr><tr style=\"height:15pt\"><td style=\"width:305pt;border-top-style:solid;border-top-width:1pt;border-top-color:#ddd;border-left-style:solid;border-left-width:1pt;border-left-color:#ddd;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#ddd;border-right-style:solid;border-right-width:1pt;border-right-color:#ddd\"><p class=\"s2\" style=\"padding-top:2pt;padding-left:7pt;text-indent:0;text-align:left\">Date(s) of Birth Used:<span class=\"s3\">{string.Join(", ", fugitive.UsedDateBirths.ToArray())}</span></p></td><td style=\"width:304pt;border-top-style:solid;border-top-width:1pt;border-top-color:#ddd;border-left-style:solid;border-left-width:1pt;border-left-color:#ddd;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#ddd;border-right-style:solid;border-right-width:1pt;border-right-color:#ddd\"><p class=\"s2\" style=\"padding-top:2pt;padding-left:7pt;text-indent:0;text-align:left\">Place of Birth:<span class=\"s3\">{fugitive.PlaceOfBirth}</span></p></td></tr><tr style=\"height:15pt\"><td style=\"width:305pt;border-top-style:solid;border-top-width:1pt;border-top-color:#ddd;border-left-style:solid;border-left-width:1pt;border-left-color:#ddd;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#ddd;border-right-style:solid;border-right-width:1pt;border-right-color:#ddd\" bgcolor=\"#EDEDED\"><p class=\"s2\" style=\"padding-top:2pt;padding-left:7pt;text-indent:0;text-align:left\">Hair:<span class=\"s3\">{fugitive.Hair}</span></p></td><td style=\"width:304pt;border-top-style:solid;border-top-width:1pt;border-top-color:#ddd;border-left-style:solid;border-left-width:1pt;border-left-color:#ddd;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#ddd;border-right-style:solid;border-right-width:1pt;border-right-color:#ddd\" bgcolor=\"#EDEDED\"><p class=\"s2\" style=\"padding-top:2pt;padding-left:7pt;text-indent:0;text-align:left\">Eyes:<span class=\"s3\">{fugitive.Eyes}</span></p></td></tr><tr style=\"height:15pt\"><td style=\"width:305pt;border-top-style:solid;border-top-width:1pt;border-top-color:#ddd;border-left-style:solid;border-left-width:1pt;border-left-color:#ddd;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#ddd;border-right-style:solid;border-right-width:1pt;border-right-color:#ddd\"><p class=\"s2\" style=\"padding-top:2pt;padding-left:7pt;text-indent:0;text-align:left\">Height:<span class=\"s3\">{fugitive.HeightMin} - {fugitive.HeightMax}</span></p></td><td style=\"width:304pt;border-top-style:solid;border-top-width:1pt;border-top-color:#ddd;border-left-style:solid;border-left-width:1pt;border-left-color:#ddd;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#ddd;border-right-style:solid;border-right-width:1pt;border-right-color:#ddd\"><p class=\"s2\" style=\"padding-top:2pt;padding-left:7pt;text-indent:0;text-align:left\">Weight:<span class=\"s3\">{fugitive.Weight}</span></p></td></tr><tr style=\"height:15pt\"><td style=\"width:305pt;border-top-style:solid;border-top-width:1pt;border-top-color:#ddd;border-left-style:solid;border-left-width:1pt;border-left-color:#ddd;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#ddd;border-right-style:solid;border-right-width:1pt;border-" +
                   $"right-color:#ddd\" bgcolor=\"#EDEDED\"><p class=\"s2\" style=\"padding-top:2pt;padding-left:7pt;text-indent:0;text-align:left\">Sex:<span class=\"s3\">{fugitive.Sex}</span></p></td><td style=\"width:304pt;border-top-style:solid;border-top-width:1pt;border-top-color:#ddd;border-left-style:solid;border-left-width:1pt;border-left-color:#ddd;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#ddd;border-right-style:solid;border-right-width:1pt;border-right-color:#ddd\" bgcolor=\"#EDEDED\"><p class=\"s2\" style=\"padding-top:2pt;padding-left:7pt;text-indent:0;text-align:left\">Race:<span class=\"s3\">White (Hispanic)</span></p></td></tr><tr style=\"height:45pt\"><td style=\"width:305pt;border-top-style:solid;border-top-width:1pt;border-top-color:#ddd;border-left-style:solid;border-left-width:1pt;border-left-color:#ddd;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#ddd;border-right-style:solid;border-right-width:1pt;border-right-color:#ddd\"><p class=\"s2\" style=\"padding-top:2pt;padding-left:7pt;text-indent:0;text-align:left\">Nationality:<span class=\"s3\">{fugitive.Nationality}</span></p></td><td style=\"width:304pt;border-top-style:solid;border-top-width:1pt;border-top-color:#ddd;border-left-style:solid;border-left-width:1pt;border-left-color:#ddd;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#ddd;border-right-style:solid;border-right-width:1pt;border-right-color:#ddd\"><p class=\"s2\" style=\"padding-top:2pt;padding-left:7pt;padding-right:2pt;text-indent:0;line-height:108%;text-align:left\">Scars and Marks:<span class=\"s3\">{fugitive.ScarsAndMarks}</span></p></td></tr><tr style=\"height:15pt\"><td style=\"width:305pt;border-top-style:solid;border-top-width:1pt;border-top-color:#ddd;border-left-style:solid;border-left-width:1pt;border-left-color:#ddd;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#ddd;border-right-style:solid;border-right-width:1pt;border-right-color:#ddd\" bgcolor=\"#EDEDED\"><p class=\"s2\" style=\"padding-top:2pt;padding-left:7pt;text-indent:0;text-align:left\">NCIC:<span class=\"s3\">{fugitive.NCIC}</span></p></td><td style=\"width:304pt;border-top-style:solid;border-top-width:1pt;border-top-color:#ddd;border-left-style:solid;border-left-width:1pt;border-left-color:#ddd;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#ddd;border-right-style:solid;border-right-width:1pt;border-right-color:#ddd\" bgcolor=\"#EDEDED\"><p style=\"text-indent:0;text-align:left\"><br></p></td></tr><tr style=\"height:246pt\"><td style=\"width:609pt;border-top-style:solid;border-top-width:1pt;border-top-color:#ddd;border-left-style:solid;border-left-width:1pt;border-left-color:#ddd;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#ddd;border-right-style:solid;border-right-width:1pt;border-right-color:#ddd\" colspan=\"2\"><p class=\"s4\" style=\"padding-top:2pt;padding-left:136pt;padding-right:135pt;text-indent:0;text-align:center\"><a name=\"bookmark3\">REWARD</a></p><p class=\"s2\" style=\"padding-top:3pt;padding-left:10pt;text-indent:0;text-align:left\">{fugitive.RewardText}</p><p class=\"s4\" style=\"padding-top:8pt;padding-left:136pt;padding-right:135pt;text-indent:0;text-align:center\"><a name=\"bookmark4\">REMARKS</a></p><p class=\"s3\" style=\"padding-top:3pt;padding-left:10pt;text-indent:0;text-align:left\">{fugitive.Remarks}</p><p class=\"s4\" style=\"padding-top:8pt;padding-left:136pt;padding-right:135pt;text-indent:0;text-align:center\"><a name=\"bookmark5\">CAUTION</a></p><p class=\"s3\" style=\"padding-top:3pt;padding-left:10pt;text-indent:0;text-align:left\">{fugitive.Caution}</p><p class=\"s4\" style=\"padding-top:5pt;padding-left:158pt;padding-right:135pt;text-indent:0;text-align:center\"><a name=\"bookmark6\">{fugitive.WarningMessage}</a></p><p style=\"padding-top:6pt;padding-left:10pt;padding-right:65pt;text-indent:0;line-height:173%;text-align:left\"><span style=\"color:#000;font-family:Arial,sans-serif;font-style:normal;font-weight:700;text-decoration:none;font-size:8pt\" target=\"_blank\">If you have any information concerning this person, please contact your local FBI office or the nearest American Embassy or Consulate. Field Office:</span>{fugitive.Offices.FirstOrDefault()}</p></td></tr></table>" +
                   "</body></html>";
        }
    }
}
